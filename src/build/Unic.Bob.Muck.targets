<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <BuildDependsOn Condition="'$(BuildingInsideVisualStudio)' == 'True'">
          $(BuildDependsOn);
          MuckLoadSettings;  
          WebFileSystemPublish;
        </BuildDependsOn>
    </PropertyGroup>
    <Target Name="MuckLoadSettings">
        <GetBobSetting Key="WebsiteCodeName" ConfigDirectory="$(BobConfigPath)">
            <Output TaskParameter="Value" PropertyName="WebsiteCodeName" />
        </GetBobSetting>
        <GetBobSetting Key="GlobalWebPath" ConfigDirectory="$(BobConfigPath)">
            <Output TaskParameter="Value" PropertyName="GlobalWebPath" />
        </GetBobSetting>
        <GetBobSetting Key="WebFolderName" ConfigDirectory="$(BobConfigPath)">
            <Output TaskParameter="Value" PropertyName="WebFolderName" />
        </GetBobSetting>
        <GetBobSetting Key="MuckRole" ConfigDirectory="$(BobConfigPath)">
            <Output TaskParameter="Value" PropertyName="MuckRole" />
        </GetBobSetting>
        <PropertyGroup>
            <publishUrl>$(GlobalWebPath)\$(WebsiteCodeName)\$(WebFolderName)</publishUrl>
            <MuckBaseFile>base</MuckBaseFile>
            <MuckPerformXmlTransform>True</MuckPerformXmlTransform>
        </PropertyGroup>
        <ItemGroup>
            <MuckTransformFileNames Include="$(_ProjectConfigFilePrefix).$(MuckBaseFile)$(_ProjectConfigFileExtension)"></MuckTransformFileNames>
            <MuckTransformFileNames Include="$(_ProjectConfigFilePrefix).$(MuckRole)$(_ProjectConfigFileExtension)"></MuckTransformFileNames>
            <MuckTransformFileNames Include="$(_ProjectConfigFilePrefix).$(MuckEnvironment)$(_ProjectConfigFileExtension)"></MuckTransformFileNames>
            <MuckTransformFileNames Include="$(_ProjectConfigFilePrefix).$(MuckEnvironment).$(MuckRole)$(_ProjectConfigFileExtension)"></MuckTransformFileNames>

        </ItemGroup>
        <Message Text="@(MuckTransformFileNames)" Importance="High"/>
    </Target>
    <Import Project="$(MSBuildThisFileDirectory)\XmlTransform.targets" />

</Project>